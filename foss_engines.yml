engines:
  - name: Stockfish-latest
    executable_path: stockfish/stockfish-ubuntu-x86-64-avx2
    setup:
      - wget https://github.com/official-stockfish/Stockfish/releases/latest/download/stockfish-ubuntu-x86-64-avx2.tar
      - tar -xvf stockfish-ubuntu-x86-64-avx2.tar
  - name: lc0-0.32
    executable_path: lc0/build/release/lc0
    neural_nets: # List of recommended NNs from https://lczero.org/play/networks/bestnets/, 7/10-25
        # All of these will be downloaded and located in the users home directory for ease of choosing network.
        # Users can also later download networks themselves, should they so choose.
        # BT4-1740 is the default network
      - https://storage.lczero.org/files/networks-contrib/big-transformers/BT4-1740.pb.gz
        # The following NNs can be set using parameters in CB, with the full file-name, e.g. "weightsfile = BT4-1024x15x32h-swa-6147500.pb.gz"
      - https://storage.lczero.org/files/networks-contrib/big-transformers/BT4-1024x15x32h-swa-6147500.pb.gz
      - https://storage.lczero.org/files/networks-contrib/BT3-768x15x24h-swa-2790000.pb.gz
      - https://storage.lczero.org/files/768x15x24h-t82-swa-7464000.pb.gz
      - https://storage.lczero.org/files/networks-contrib/t3-512x15x16h-distill-swa-2767500.pb.gz
      - https://storage.lczero.org/files/networks-contrib/t1-512x15x8h-distilled-swa-3395000.pb.gz
      - https://storage.lczero.org/files/networks-contrib/t1-256x10-distilled-swa-2432500.pb.gz
    setup:
        #This is rather painful, and potentially vulnerable to both updates to Debian, Nvidia and Lc0.
      - rm -rf ~/*
        #Avoid a popup requesting choice of country for keyboard
      - sudo DEBIAN_FRONTEND=noninteractive
      - sudo apt-get update
        # Installation of nVidia drivers as per https://cloud.google.com/compute/docs/gpus/install-drivers-gpu
      - sudo apt-get install python3
      - curl -L https://storage.googleapis.com/compute-gpu-installation-us/installer/latest/cuda_installer.pyz --output cuda_installer.pyz
        # Installation of nvidia driver, will generate a reboot.
      - sudo python3 cuda_installer.pyz install_driver --installation-mode=binary --installation-branch=prod
        # Installation of cuda driver, will generate a reboot.
      - sudo python3 cuda_installer.pyz install_cuda --installation-mode=binary --installation-branch=prod
      - wget https://developer.download.nvidia.com/compute/cudnn/9.13.1/local_installers/cudnn-local-repo-debian12-9.13.1_1.0-1_amd64.deb
      - sudo dpkg -i cudnn-local-repo-debian12-9.13.1_1.0-1_amd64.deb
      - sudo cp /var/cudnn-local-repo-debian12-9.13.1/cudnn-*-keyring.gpg /usr/share/keyrings/ 
      - sudo apt-get update
        # Installation of cudnn driver, will not generate a reboot.
      - sudo apt-get -y install cudnn
        # Build of Lc0 according to https://github.com/LeelaChessZero/lc0
      - sudo apt-get -y install git python3-pip gcc g++ zlib1g zlib1g-dev ninja-build meson
      - git clone -b release/0.32 https://github.com/LeelaChessZero/lc0.git
      - cd lc0 && INSTALL_PREFIX=~/.local ./build.sh
        # Putting the BT4-1740 network will ensure Lc0 always has a network it can load by default.
        # A second copy will be present in the home directory, where the binary is launched from,
        # in case the user sets BT4-1740.pb.gz as the weights file
      - cd ~/lc0/build/release && wget https://storage.lczero.org/files/networks-contrib/big-transformers/BT4-1740.pb.gz
